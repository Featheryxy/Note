### 操作系统的定义和特性

操作系统（OS）是控制计算机软、硬件资源和方便用户管理的程序集合。

特性：并发性，共享性，虚拟性，异步性（不确定性）

### 操作系统的三种基本类型

#### 1. 批处理系统

- 单道批处理系统：内存中只有一道作业
- 多道批处理系统：内存中有多道作业共享CPU和其他资源

#### 2. 分时系统

内存中保持多个用户的多个作业，由操作系统负责协调多个用户分享CPU

#### 3. 实时系统

计算机能及时响应外部事件的请求，在规定的严格时间内完成对该事情的处理，并控制所有实时设备和任务协调一致地工作的操作系统

### 操作系统的功能

1. 处理机管理
2. 存储器管理
3. 设备管理功能
4. 文件管理功能



### 进程

#### 原语

原语（primitive）由若干条指令组成的，用于完成一定功能的一个过程。

#### 定义

进程是程序的动态执行过程，是**分配和管理资源的基本单位**

进程实体 = 程序段+相关数据段+PCB(Process Control Block)

操作系统通过PCB对进程进行控制，PCB是进程的唯一标志

#### 进程的三种基本状态

1. 就绪：除了CPU外，进程已经分到了其他所有需要的资源
2. 执行：进程占有CPU
3. 阻塞(等待)：进程由于等待某种条件（如I/O）无法继续执行，将CPU资源释放。当条件满足后会进入就绪状态

#### 线程

**线程**是进程中能够并发执行的实体，是进程的组成部分。多线程操作系统中，进程只是拥有资源的基本单位，而不是一个可执行的实体，每个线程是一个**可执行的实体**，是**CPU调度和分派的基本单位，基本上不拥有系统资源，共享进程资源**

### 高级通信机制

#### 1. 共享存储器系统

进程之间通过共享某项数据结构或**共享存储区**进行通信

#### 2. 消息传递（主流）

进程之间通过**格式化的消息**为单位进行通信

#### 3. 管道通信

管道：指用于连接一个读进程和一个写进程以实现他们之间通信的**共享文件（pipe文件）**。

管道是单向的

### 处理机调度的层次

#### 1. 作业调度

又称为宏观调度，高级调度，根据某种算法，把外存上处于后备队列中的作业调入内存

作业：用户要求计算机所作的关于一次业务处理的全部工作，是一个比程序更为广泛的概念。

作业的生命周期：

1. 提交

   作业从输入设备进入外部存储设备

2. 收容

   输入管理系统不断从作业输入到外存中对应部分（输入井，专门用来存放待处理作业信息的一组外存分区）

3. 执行

   作业调度程序从后备作业中选取若干个作业到内存投入运行。建立进程并分配必要的资源。宏观上，该作业处在执行过程中，微观上，可能没有分配到CPU资源。

3. 完成
	
	作业完成后，其所占有的资源未全部被系统回收
   

#### 3. 中级调度

将暂时不能运行的进程调至外存上等待，此时的进程状态被称为挂起，swap区

#### 3. 进程调度

又称为低级调度，微观调度，决定**就绪队列**中的哪个进程应获得CPU

进程调度的方式分为两种：

1. 抢占式：优先权有限，短作业/进程优先原则，时间片原则
2. 非抢占式

### 调度算法

#### 1.算法衡量指标

1. 平均周转时间
   $$
   T = \frac{\sum_{i=1}^{n}T_i}{n} \\
   T_i为作业i的周转时间
   $$
   
2. 平均带权周转时间

$$
T = \frac{\sum_{i=1}^{n} \frac{T_i}{T_{s_i}}}{n} \\
T_{s_i}为系统提供的服务时间
$$

#### 2. 先来先服务调度算法

先来先服务（FCFS）：把当前处于就绪队列之首的那个进程调度到运行状态。

优缺点：

#### 3. 短作业/进程优先调度算法

#### 4. 高优先权优先调度算法

#### 5. 时间片轮转法

为每一个进程分配一个时间段（时间片），即允许该进程运行的时间。每个进程只能依次循环轮流运行，如果时间片结束时进程还在运行，CPU将剥夺该进程的使用权而将CPU分配给另一个进程

### 死锁

各并发进程彼此相互等待对方所拥有的资源，且这些并发进程在得到对方的资源之前不会释放自己所拥有的资源。从而造成各方都想得到资源而又得不到资源，各并发进程不能继续向前推进的死等状态。

原因：

1. 竞争资源
2. 进程推进顺序不当

必要条件

1. 互斥条件：非共享资源
2. 不剥夺条件（非抢占）：
3. 占有和等待条件
4. 循环等待条件

### 虚拟存储管理

虚拟存储器（Virtual Memory), 也称为虚拟内存，使用一部分外存来充当内存空间。对系统程序不透明，但对应用程序时透明的（看不见）。其**目的是扩充主存容量**

#### 特征

1. 多次行

   一个作业中的程序和数据无需一次性装入内存，而是允许被分成多次调入内存运行，只将当前需要的部分程序和数据装入内存

2. 对换性

   作业中的程序和数据无需一直常驻内存，运行其在作业的运行过程中进行换进换出

3. 虚拟性

   从逻辑上扩充内存容量